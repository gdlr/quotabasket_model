---
title: "Health status results"
author: "mauricio"
date: "2/27/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(here)
library(scales)
library(gridExtra)
library(grid)
library(kableExtra)
```

```{r}
# Read files results

# general output files
output_sc1 <- read_csv(here("working_model","k explore","model run results files","output_b_carry1.csv")) %>% 
  mutate(run = "Scenario 1",
         year = seq(0,30))
output_sc2 <- read_csv(here("working_model","k explore","model run results files","output_b_carry2.csv"))%>% 
  mutate(run = "Scenario 2",
         year = seq(0,30))
output_sc3 <- read_csv(here("working_model","k explore","model run results files","output_b_carry3.csv"))%>% 
  mutate(run = "Scenario 3",
         year = seq(0,30))

# sum of profits

npv_sc1 <- read_csv(here("working_model","k explore","model run results files","NPV_b_carry1.csv")) %>% 
  mutate(run = "Scenario 1")
npv_sc2 <- read_csv(here("working_model","k explore","model run results files","NPV_b_carry2.csv")) %>% 
  mutate(run = "Scenario 2")
npv_sc3 <- read_csv(here("working_model","k explore","model run results files","NPV_b_carry3.csv")) %>% 
  mutate(run = "Scenario 3")

#Group them
all_outputs <- rbind(output_sc1, output_sc2, output_sc3) %>% 
  mutate(tot_profits = profit_per_t.t_1+profit_per_t.t_2+profit_per_t.t_3+profit_per_t.t_4+profit_per_t.t_5,
         tot_stock=stock.s_1+stock.s_2+stock.s_3+stock.s_4+stock.s_5)

NPVs <- rbind(npv_sc1, npv_sc2, npv_sc3) %>% 
  rename(total_profit=x)

```

# 1. Scenarios

In this section, we test how grouping stocks by their carrying capacity affect the profits, biomass and effort allocation. We are considering 3 species/fish have a medium carrying capacity (K = 100), and 2 species/fish with higher carrying capacity (K = 300) at time zero. 

We considered 3 arrangement for the quota baskets:
- *Species with similar K:* we have a QB of normal K and a group of high K.
- *The normal K species predominates in a basket:* we have a QB were the "normal K" species predominates (2 normal K and 1 high K), and the other basket has the remaining species (1 normal K and 1 high K).
- *The high K species predominates in a basket:*we have a QB were the "high K" species predominates (1 normal K and 2 high K), and the other basket has the remaining species (2 normal K).

We are going to compare these arrangements in terms of biomass, efforts, ant total profits.  

# 2. Biomass

## 2.1 Biomass per species

```{r}
# Graph
ggplot(data = all_outputs)+
  geom_line(aes(y=stock.s_1, x=year), color="purple")+ 
  geom_line(aes(y=stock.s_2, x=year), color="royalblue")+ 
  geom_line(aes(y=stock.s_3, x=year), color="lightblue")+ 
  geom_line(aes(y=stock.s_4, x=year), color="red")+ 
  geom_line(aes(y=stock.s_5, x=year), color="orange")+ 
  theme_minimal()+
  labs(x= "Years",
         y= "Stock Level (tons)")+
  facet_wrap(~ run, nrow=2)

```

## 2.2 Total biomass in the ocean

```{r}
# Graph
ggplot(data = all_outputs, aes(y=tot_stock, x=year, group=run, color=run))+
  geom_line()+
  theme_minimal()+
  labs(x= "Years",
         y= "Stock (tons)")
  
```

# 3. Effort

```{r}
# Graph
ggplot(data = all_outputs)+
  geom_line(aes(y=effort.t_1, x=year), color="purple")+ 
  geom_line(aes(y=effort.t_2, x=year), color="royalblue")+ 
  geom_line(aes(y=effort.t_3, x=year), color="lightblue")+ 
  geom_line(aes(y=effort.t_4, x=year), color="red")+ 
  geom_line(aes(y=effort.t_5, x=year), color="orange")+ 
  theme_minimal()+
  labs(x= "Years",
         y= "Effort (units)")+
  facet_wrap(~ run, nrow=2)

```

# 4. Profit

# 4.1 Profit per technology
```{r}
# Graph
ggplot(data = all_outputs)+
  geom_line(aes(y=profit_per_t.t_1, x=year), color="purple")+ 
  geom_line(aes(y=profit_per_t.t_2, x=year), color="royalblue")+ 
  geom_line(aes(y=profit_per_t.t_3, x=year), color="lightblue")+ 
  geom_line(aes(y=profit_per_t.t_4, x=year), color="red")+ 
  geom_line(aes(y=profit_per_t.t_5, x=year), color="orange")+ 
  theme_minimal()+
  labs(x= "Years",
         y= "Profit (dollars)")+
  facet_wrap(~ run, nrow=2)

```

# 4.2 Total profit per scenario

```{r}
# Graph
ggplot(data = all_outputs, aes(y=tot_profits, x=year, group=run, color=run))+
  geom_line()+
  theme_minimal()+
  labs(x= "Years",
         y= "Profit (dollars)")

```



