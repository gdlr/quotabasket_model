---
title: "Multi_Efforts"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

# Packages
library(tidyverse)
library(Matrix)
library(kableExtra)
library(ggplot2)
library(plotly)
library(lpSolve)
library(lpSolveAPI)
```

```{r}
source("stock_dynamic.R")
source("harvest_species.R")
source("harvest_tech.R")
source("profit_tech.R")
source("pvnb.R")
```

```{r} 
# First, set seed to ensure we have the same result 
set.seed(666)


# set the number of species and technologies we want to study
species_num <- 4
tech_num <- 4


# set the number of years we want to model the stock dynamic 
year = 5

# set the discount rate
delta = 0.05
rho = 1/(1+delta)


# set values for variables in the "Our Model" section
# set parameters
species <- c(1:species_num)
parameter <- data.frame(species)
parameter$r <- c(1,0.5,0.4,0.9)
parameter$K <- c(1,1.2,2,3)
parameter$X0 <- c(0.5,0.6,1,1)
parameter$p <- c(200,200,200,200)
parameter$c <- c(1,1,1,1)
parameter$delta <- c(0.05,0.05,0.05,0.05)
parameter$rho <- 1/(1+parameter$delta)

# set catchability coefficient 
coefficient <- c(0.05,0.05,0.07,0.07,
                 0.04,0.05,0.05,0.05,
                 0,0.011,0.05,0.05,
                 0,0.01,0.02,0.05)

q_matrix <- matrix(coefficient, nrow = tech_num, ncol = species_num)

species_tech_matrix <- data.frame(q_matrix, nrow = tech_num, ncol = species_num)

# set effort for each tech 
E <- c(0.5,0.5,0.05,0.05)

# set cost for each tech
C <- c(1,1,2,2)
```

```{r}
# generate map data for each combination of E1 E2 E3 and E4
E_1 <- seq(0,8,1)
E_2 <- seq(0,8,1)
E_3 <- seq(0,8,1)
E_4 <- seq(0,8,1)


```

```{r}
E_new <- NULL


for(i in 1:length(E_1)){
  for(j in 1:length(E_2)){
    for(k in 1:length(E_3)){
      for(l in 1:length(E_4)){
        E_new <- rbind(E_new, c(E_1[i],E_2[j],E_3[k],E_4[l]))
      }
    }
  }
}

```

```{r}
pvnb_vec <- NULL
for(i in 1:nrow(E_new)){
   tmp_E <- E_new[i,]
   tmp_pvnb <- pvnb(tmp_E)
   pvnb_vec <- append(pvnb_vec,tmp_pvnb)
}
E_new <- data.frame(E_new)
colnames(E_new) <- c("E1", "E2", "E3", "E4")
E_new$PVNB <- pvnb_vec
```


```{r}
E_new <- E_new %>% 
  arrange(-PVNB)

PVNB_table = kbl(E_new[c(1:10),], caption = "Top 10 PVNB under 4 types of fishing efforts") %>%
  kable_classic(full_width = F, html_font = "Cambria")

PVNB_table
```

